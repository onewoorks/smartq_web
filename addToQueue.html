<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>

    <head>
        <title>Add To Queue</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="assets/javascript/jquery-1.11.1.min.js" ></script>
    </head>
    <body>
        <div id='preregisterform'>
        <h1>Patient Pre-Register</h1>
        <form id='sendPatient'>
            <input name='org_id' id='org_id' value='' /><br>
            <input name='name' placeholder="name" /><br>
            <input name='identification_no' placeholder="identification_no" /><br>
            <input name='contact_no' placeholder="contact_no"/><br>
            <textarea name='address' placeholder="alamat"></textarea><br>
            <button type='submit'>Pre Register</button>
        </form>
        </div>

        <div id='preregistermessage'></div>
        <script>
            function getUrlVars() {
                var vars = {};
                var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,
                        function(m, key, value) {
                            vars[key] = value;
                        });
                return vars;
            }
            $(function() {
                var $org_id = getUrlVars()['id'];
                $('#org_id').val($org_id);
                $('#sendPatient').submit(function(e) {
                    e.preventDefault();
                    var values = $(this).serializeArray();
                    $.ajax({
                        type: 'POST',
                        data : {values : values},
                        url: 'http://localhost:81/spp-helpdesk/smartq_api/queue.json',
                        dataType:'json',
                        success: function(data) {
                            var your_queue_no;
                            $(data).each(function(i,v){
                                your_queue_no = v.queue_no;
                            });
                            $('#preregisterform').remove();
                            $('#preregistermessage').html('Your queue number is '+ your_queue_no);
                        }
                    });
                });

            });
        </script>
    </body>
</html>
